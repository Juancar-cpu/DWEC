<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formulario de Registro</title>
<style>

body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        }
        .container{
            display: flex;
            justify-content: center;
            align-items: center;  
       }

       fieldset{
        width: fit-content;
       }
       button{
        background-color: #620af0;
        color: #fff;
        border: none;
        cursor: pointer;background-color: blueviolet;
        color:white;
       }
       .mensajeError{
            color:red;
        }
    .error {
        color: red;
    }
    .success {
        color: green;
    }
</style>
</head>
<body>

    <fieldset>
<h2>Formulario de Registro</h2>
<form id="registrationForm" onsubmit="return validateForm()">
    <div>
        <label for="nombre">Nombre:</label><br>
        <input type="text" id="nombre" name="nombre" required><br><!--al tener todos required no nos deja pasar al siguiente hasta completa el actual, haciendole foco a él-->
        <span id="errorNombre" class="error"></span>
    </div>
    <div>
        <label for="email">Correo electrónico:</label><br>
        <input type="email" id="email" name="email" required><!--El patron del mail es tratado en el js-->
        <span id="errorEmail" class="error"></span>
    </div>
    <div>
        <label for="phone">Número de Teléfono:</label><br>
        <input type="tel" id="phone" name="phone" required pattern="[0-9]{9}"><!--numero de telefono debe tener 9 caracteres y estos ser todos numeros-->
        <span id="errorPhone" class="error"></span>
    </div>
    <div>
        <label for="password">Contraseña:</label><br>
        <input type="password" id="password" name="password" required><!--La contraseña y la confirmacion de esta son tratadas en el js-->
        <span id="errorPassword" class="error"></span>
    </div>
    <div>
        <label for="confirmPassword">Confirmar Contraseña:</label><br>
        <input type="password" id="confirmPassword" name="confirmPassword" required>
        <span id="errorConfirmPassword" class="error"></span>
    </div>
    <button type="submit">Registrarse</button><br>
    <div id="formMessages"></div>
</form>
</fieldset>
<script>
function validateForm() {
    //Primero capturamos el valor de todos los campos y los metemos en variables gracias al getElementById
    var nombre = document.getElementById("nombre").value;
    var email = document.getElementById("email").value;
    var password = document.getElementById("password").value;
    var confirmPassword = document.getElementById("confirmPassword").value;
    var phone = document.getElementById("phone").value;
    var errorMessages = [];//Los mensajes de error van a ir dentro de un array para asi meter varios

    // Validación del nombre
    if (!/^[a-zA-Z]+$/.test(nombre)) {//Con este patrón nos aseguramos de que el nombre no tenga carásteres especiales
        errorMessages.push("El nombre debe contener solo letras.");
    }

    // Validación del correo electrónico
    if (!/\S+@\S+\.\S+/.test(email)) {//si el mail no cumple con el formato establecido...
        errorMessages.push("El correo electrónico debe tener un formato válido.");//damos un mensaje apropiado
    }

    // Validación de la contraseña
    if (password.length < 8 || !/[a-z]/.test(password) || !/[A-Z]/.test(password) || !/\d/.test(password)) {//Si la contraseña tiene menos de 8 caracteres, no incluye minusculas, no incluye mayusculas ni un numero...
        errorMessages.push("La contraseña debe tener al menos 8 caracteres, una letra mayúscula, una letra minúscula y un número.");//salta el error
    }

    // Validación de la confirmación de la contraseña
    if (confirmPassword !== password) {
        errorMessages.push("La confirmación de la contraseña debe coincidir con la contraseña.");
    }

    // Validación del número de teléfono
    if (!/^\d{9}$/.test(phone)) {//Nos aseguramos que, efectivamente, se cumple el patron dado en el js
        errorMessages.push("El número de teléfono debe contener nueve dígitos.");
    }

    var formMessages = document.getElementById("formMessages");//capturamos el div que va a llevar los mensajes de error
    var errorMessagesHtml = "<ul class='error'>";//Le damos la clase error para que gane su css
    errorMessages.forEach(function(message) {//recorremos mensajes de error con un foreach
        errorMessagesHtml += "<li>" + message + "</li>";//formamos elementos de una lista, cada uno con el mensaje apropiado
    });
    errorMessagesHtml += "</ul>";//Creamos el elemento lista que contendrá todos los li con mensajes
    formMessages.innerHTML = errorMessagesHtml;//metemos los elementos li dentro de ul

    if (errorMessages.length > 0) {//Si la longitud es mayor a 0 significa que ha saltado un error
        return false;
    } else {
        formMessages.innerHTML = "<p class='success'>¡Registro exitoso!</p>";//si todo va bien sale el mensaje aropiado en verde
        return true;
    }
}

document.addEventListener("input", function(event) {//funcion switch para tratar los mensajes que salen al instante si se rellena mal un campo
    var element = event.target;
    var errorSpanId = "error" + element.id.charAt(0).toUpperCase() + element.id.slice(1);
    var errorMessage = "";

    switch (element.id) {//Vamos comprobando en que id estamos para no usar una cadena de if else y ganar algo de 
        case "nombre":
            errorMessage = "El nombre debe contener solo letras.";
            break;
        case "email":
            errorMessage = "El correo electrónico debe tener un formato válido.";
            break;
        case "password":
            errorMessage = "La contraseña debe tener al menos 8 caracteres, una letra mayúscula, una letra minúscula y un número.";
            break;
        case "confirmPassword":
            errorMessage = "La confirmación de la contraseña debe coincidir con la contraseña.";
            break;
        case "phone":
            errorMessage = "El número de teléfono debe contener nueve dígitos.";
            break;
    }

    var errorSpan = document.getElementById(errorSpanId);
    if (!element.checkValidity()) {
        errorSpan.textContent = errorMessage;
    } else {
        errorSpan.textContent = "";
    }
});
</script>

</body>
</html>
