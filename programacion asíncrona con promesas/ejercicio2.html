<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!--Pagina web con un div para mensajes y un boton que genere una promesa que invoque a una funcion llamada probarPromise
    
        La funcion probar Promise debe:
        Contar las veces que se pulsa el boton y sacar en el div los siguientes mensajes:
    1) antes de construir la promesa:  "cont() empieza el codigo sincrono"
    2) Dentro de la promesa antes de resolverla: "cont() Dentro de la promesa, antes del timeout. Empieza el codigo asincrono"
    3) Dentro de then: "cont()Dentro del then. Codigo asincrono terminado"
    4) Fuera de la promesa: "cont()Codigo despues del then. Codigo sincrono terminado
    
    Para la promesa usar: 
        setTimeout(() => {
    resolve(this.contador());
}, Math.random() * 4000 + 1000);
-->

        <button id="boton">Generar Promesa</button>
        <div id="mensaje"></div>

        <script>
            /*var mensaje = "";
            document.getElementById("boton").addEventListener("click", probarPromise, false);

            function probarPromise(evento){
                //Mensaje antes de la promesa
                mensaje += "1) Empieza el codigo asincrono";
                document.getElementById("mensaje").innerHTML=mensaje;

                //Construir la promesa y mensaje antes del setTimeout
                const miPromesa = new Promise((resolve, reject)=>{
                    mensaje +="<br>2) Dentro de la promesa, antes del timeout. Empieza el codigo asíncrono"
                    document.getElementById("mensaje").innerHTML=mensaje;

                    setTimeout(() => {
                         resolve(this.contador());
                        }, Math.random() * 4000 + 1000);
                    })

                    mensaje+="<br>3) Dentro del then. Codigo asíncrono terminado";
                     miPromesa.then(mensaje => document.getElementById("mensaje").innerHTML=mensaje);
                     
                     mensaje+="<br>4) Código despues del then. Codigo sincrono terminado";
                     document.getElementById("mensaje").innerHTML=mensaje}*/

        



    // Función contador
    function contador() {
        // Aquí puedes implementar la lógica de contar las veces que se pulsa el botón
        return "Contador incrementado";
    }

    // Función probarPromise
    function probarPromise() {
        // Mensaje antes de construir la promesa
        document.getElementById("mensaje").innerHTML = "1) " + contador() + " Empieza el codigo sincrono";

        // Construir la promesa
        let miPromesa = new Promise((resolve, reject) => {
            // Mensaje dentro de la promesa antes de resolverla
            document.getElementById("mensaje").innerHTML += "<br>2) " + contador() + " Dentro de la promesa, antes del timeout. Empieza el codigo asincrono";

            // Simular operación asincrónica con setTimeout
            setTimeout(() => {
                resolve(contador());
            }, Math.random() * 4000 + 1000);
        });

        // Usar then para manejar la resolución de la promesa
        miPromesa.then((resultado) => {
            // Mensaje dentro de then
            document.getElementById("mensaje").innerHTML += "<br>3) " + resultado + " Dentro del then. Codigo asincrono terminado";
        }).finally(() => {
            // Mensaje fuera de la promesa
            document.getElementById("mensaje").innerHTML += "<br>4) Codigo despues del then. Codigo sincrono terminado";
        });
    }

    // Event listener para el botón
    document.getElementById("boton").addEventListener("click", probarPromise, false);



            
        </script>
</body>
</html>